<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GoCåœ¨çº¿ç¼–ç¨‹</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  html, body { 
    height: 100%; 
    margin: 0; 
    padding: 0; 
    overflow: hidden;
  }
  .goc-container { 
    height: 100vh; 
    width: 100vw;
    display: flex; 
    flex-direction: column; 
    background: #f5f5f5; 
    position: fixed;
    top: 0;
    left: 0;
    margin: 0;
    padding: 0;
  }
  .goc-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 15px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  }
  .goc-title {
    font-size: 24px;
    font-weight: bold;
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .goc-badge {
    background: rgba(255,255,255,0.2);
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 12px;
  }
  .goc-toolbar {
    display: flex;
    gap: 10px;
  }
  .goc-btn {
    padding: 8px 16px;
    border: none;
    border-radius: 6px;
    background: rgba(255,255,255,0.2);
    color: white;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.3s ease;
    backdrop-filter: blur(10px);
  }
  .goc-btn:hover {
    background: rgba(255,255,255,0.3);
    transform: translateY(-1px);
  }
  .goc-btn.primary {
    background: #10b981;
  }
  .goc-btn.primary:hover {
    background: #059669;
  }
  .goc-iframe-container {
    flex: 1;
    position: relative;
    overflow: hidden;
    margin: 0;
    padding: 0;
  }
  #gocIframe { 
    width: 100%; 
    height: 100%; 
    border: none; 
    display: block; 
    margin: 0;
    padding: 0;
  }
  .back-btn {
    background: rgba(255,255,255,0.15);
    color: white;
    border: 1px solid rgba(255,255,255,0.3);
    padding: 8px 16px;
    border-radius: 6px;
    text-decoration: none;
    transition: all 0.3s ease;
  }
  .back-btn:hover {
    background: rgba(255,255,255,0.25);
    color: white;
    text-decoration: none;
  }
</style>
</head>
<body>

<div class="goc-container">
  <div class="goc-header">
    <div class="goc-title">
      <span>ğŸ¨</span>
      <span>GoCåœ¨çº¿ç¼–ç¨‹ç¯å¢ƒ</span>
      <span class="goc-badge">æ±Ÿæ¶›è€å¸ˆç‹¬åˆ›</span>
    </div>
    <div class="goc-toolbar">
      <a href="/" class="back-btn">â† è¿”å›é¦–é¡µ</a>
      <button id="initBtn" class="goc-btn" title="ä½¿ç”¨å…¨æ–°çª—å£ç¼–å·é‡æ–°åŠ è½½ï¼Œå¾—åˆ°ä»…å« int main() çš„ç©ºç™½æ¨¡æ¿">ğŸ”„ åˆå§‹åŒ–</button>
      <button id="openNewTab" class="goc-btn primary" title="åœ¨æ–°çª—å£æ‰“å¼€åœ¨çº¿ç¼–ç¨‹é¡µ">ğŸš€ æ–°çª—å£</button>
    </div>
  </div>
  
  <div class="goc-iframe-container">
    <iframe
      id="gocIframe"
      title="GoC åœ¨çº¿ç¼–ç¨‹"
      src=""
      referrerpolicy="no-referrer-when-downgrade"
      loading="eager"
    ></iframe>
  </div>
</div>

<script>
;(function () {
  function buildUrlFromSearch() {
    var base = 'http://47.99.149.106:10086/static/gocWebNet/gocWebNet.html';
    var params = new URLSearchParams(window.location.search);
    if (!params.has('submitBt')) params.set('submitBt', '0');
    if (!params.has('insert')) params.set('insert', '0');
    if (!params.has('ra')) params.set('ra', '60');
    // æ¯æ¬¡æ‰“å¼€éƒ½æ˜¯"æœ¬åœ°çª—å£"ï¼šç”Ÿæˆä¸€ä¸ªå¸¦æ—¶é—´æˆ³çš„ winNameï¼Œé¿å…å¤ç”¨æ—§ä¼šè¯
    params.set('winName', 'hydro_goc_' + Date.now());
    return base + '?' + params.toString();
  }

  function buildBlankInitUrl() {
    var base = 'http://47.99.149.106:10086/static/gocWebNet/gocWebNet.html';
    // ä½¿ç”¨ä¸€ä¸ªæ–°çš„éšæœºçª—å£åï¼Œé¿å…ç»§æ‰¿æ—§çŠ¶æ€ï¼›ä¿æŒæŒ‰é’®é»˜è®¤å…³é—­
    var params = new URLSearchParams({
      submitBt: '0',
      insert: '0',
      ra: '60',
      winName: 'hydro_init_' + Date.now()
    });
    return base + '?' + params.toString();
  }

  document.addEventListener('DOMContentLoaded', function () {
    var iframe = document.getElementById('gocIframe');
    var url = buildUrlFromSearch();
    iframe.src = url;
    
    // ç›‘å¬åŠ è½½å®Œæˆåï¼Œè§¦å‘ä¸€æ¬¡å°ºå¯¸"è½»æ¨"ï¼Œä¿ƒä½¿å†…éƒ¨å¸ƒå±€è®¡ç®—
    iframe.addEventListener('load', function () {
      try {
        // å°è¯•é€šè¿‡æ”¹å˜ iframe çš„é«˜åº¦ 1px å†æ¢å¤æ¥è§¦å‘é‡æ’
        var h = iframe.style.height || window.getComputedStyle(iframe).height;
        iframe.style.height = 'calc(100% - 1px)';
        // ä¸‹ä¸€å¸§æ¢å¤
        requestAnimationFrame(function () {
          iframe.style.height = h || '100%';
        });
      } catch (e) {
        // å¿½ç•¥è·¨åŸŸå¯¼è‡´çš„è®¿é—®é™åˆ¶
      }
    });

    // çª—å£å°ºå¯¸å˜åŒ–æ—¶ä¹Ÿåšä¸€æ¬¡è½»æ¨
    window.addEventListener('resize', function () {
      var h = iframe.style.height || window.getComputedStyle(iframe).height;
      iframe.style.height = 'calc(100% - 1px)';
      requestAnimationFrame(function () {
        iframe.style.height = h || '100%';
      });
    });

    // åˆå§‹åŒ–æŒ‰é’®ï¼šåŠ è½½ä¸€ä¸ªå…¨æ–°ä¼šè¯ï¼ˆä»…å«ç©ºç™½æ¨¡æ¿ï¼‰
    var initBtn = document.getElementById('initBtn');
    if (initBtn) {
      initBtn.addEventListener('click', function () {
        var initUrl = buildBlankInitUrl();
        iframe.src = initUrl;
      });
    }

    // æ–°çª—å£æŒ‰é’®
    var openNewTab = document.getElementById('openNewTab');
    if (openNewTab) {
      openNewTab.addEventListener('click', function () {
        // å¤åˆ¶å½“å‰é¡µé¢åˆ°æ–°çª—å£ï¼Œè€Œä¸æ˜¯è·³è½¬åˆ°å¤–éƒ¨GoCç½‘ç«™
        window.open(window.location.href, '_blank', 'noopener,noreferrer');
      });
    }
  });
})();
</script>
</body>
</html>
